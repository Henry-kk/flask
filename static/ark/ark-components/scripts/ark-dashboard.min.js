"use strict";angular.module("ark-dashboard",["ark-ui-bootstrap","ui.sortable","nvd3"]),angular.module("ark-dashboard").directive("dashboard",["WidgetModel","ExpandToTabModel","WidgetDefCollection","$modal","DashboardState","$log","DashboardMenuObject",function(a,b,c,d,e,f,g){return{restrict:"A",templateUrl:function(a,b){return b.templateUrl?b.templateUrl:"src/dashboard/template/dashboard.html"},scope:!0,controller:["$scope","$attrs",function(a,b){var c={stringifyStorage:!0,hideWidgetSettings:!1,hideWidgetClose:!1,settingsModalOptions:{templateUrl:"src/dashboard/template/rename-template.html",controller:"renameModalCtrl"}};a.options=a.$eval(b.dashboard),a.options.settingsModalOptions=a.options.settingsModalOptions||{},_.each(["settingsModalOptions"],function(b){a.options[b]=a.options[b]||{},_.defaults(a.options[b],c[b])}),_.defaults(a.options,c);var d={stop:function(){a.saveDashboard()},handle:".widget-header"};a.sortableOptions=angular.extend({},d,a.options.sortableOptions||{})}],link:function(f){function h(a){f.options.unsavedChangeCount=0,a&&a.length?f.loadWidgets(a):f.defaultWidgets?f.loadWidgets(f.defaultWidgets):f.clear(!0)}f.widgetList=new g(f.options.customWidgetDropdownMenu,f.options.customWidgetDropdownActions),f.defaultWidgetActions=[{expandToTab:function(a){f.expandToTab(a)}},{renameWidget:function(a){f.openWidgetSettings(a)}},{clone:function(a){f.clone(a)}},{removeWidget:function(a){f.removeWidget(a)}}],f.defaultWidgets=f.options.defaultWidgets,f.widgetDefs=new c(f.options.widgetDefinitions);var i=1;f.dashboardState=new e(f.options.storage,f.options.storageId,f.options.storageHash,f.widgetDefs,f.options.stringifyStorage),f.gridsterOpts={columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:200,margins:[0,0],outerMargin:!0,isMobile:!0,mobileBreakPoint:767,mobileModeEnabled:!0,minColumns:1,minRows:2,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:2,maxSizeY:null,resizable:{enabled:!0,handles:["n","e","s","w","ne","se","sw","nw"],stop:function(){f.resize()}},draggable:{enabled:!0,handle:".widget-anchor",stop:function(){f.drag()}}},f.resize=function(){f.saveDashboard(!0)},f.drag=function(){f.saveDashboard(!0)},f.addWidget=function(b,c){var d=f.widgetDefs.getByName(b.name);if(!d)throw"Widget "+b.name+" is not found.";var e;e=b.title?b.title:d.title?d.title:"Widget "+i++;var g,h;b.sizeX&&(g=b.sizeX),b.sizeY&&(h=b.sizeY);var j,k;b.row&&(j=b.row),k=b.col?b.col:0,b=angular.extend(b,d);var l=b.chartOptions,m=b.chartData,n=new a(b,{title:e,sizeX:g,sizeY:h,row:j,col:k,chartOptions:l,chartData:m});return f.widgets.push(n),c||f.saveDashboard(),n},f.removeWidget=function(a){f.widgets.splice(_.indexOf(f.widgets,a),1),f.saveDashboard(!0)},f.expandToTab=function(a){var c=f.$parent.$parent.createNewLayout(!0),d=a.title,e=a.chartData,g=a.chartOptions,h=new b(a,{title:d,chartData:e,chartOptions:g,sizeX:6,sizeY:6});c.dashboard.defaultWidgets=[h],f.saveDashboard()},f.openWidgetSettings=function(a){var b=_.defaults({scope:f},a.settingsModalOptions,f.options.settingsModalOptions);b.resolve={title:function(){return a.title},type:function(){return"Widget"}};var c=a.title,e=d.open(b);e.result.then(function(b){a.title=b,f.$emit("widgetChanged",a),f.saveDashboard(!0)},function(){a.title=c})},f.clear=function(a){f.widgets=[],a!==!0&&f.saveDashboard(!0)},f.clone=function(b){var c,d,e=b.title;b.sizeX&&(c=b.sizeX),b.sizeY&&(d=b.sizeY);var g=new a(b,{title:e,sizeX:c,sizeY:d});return f.widgets.push(g),f.saveDashboard(),g},f.addWidgetInternal=function(a,b){a.preventDefault(),f.addWidget(b)},f.saveDashboard=function(a){f.options.explicitSave?(angular.isNumber(f.options.unsavedChangeCount)||(f.options.unsavedChangeCount=0),a?(f.options.unsavedChangeCount=0,f.dashboardState.save(f.widgets)):++f.options.unsavedChangeCount):f.dashboardState.save(f.widgets)},f.externalSaveDashboard=function(){f.saveDashboard(!0)},f.loadWidgets=function(a){f.savedWidgetDefs=a,f.clear(!0),_.each(a,function(a){f.addWidget(a,!0)})},f.resetWidgetsToDefault=function(){f.loadWidgets(f.defaultWidgets),f.saveDashboard()};var j=f.dashboardState.load();angular.element(document).on("click","a.nav-tabs-dropdown",function(a){angular.element(".widget-container").removeClass("gridster-item-moving-dropdown-open"),angular.element(this).closest(".widget-container").addClass("gridster-item-moving-dropdown-open");var b=angular.element(window).width(),c=a.pageX;220>b-c?(angular.element(".nav-tabs-dropdown-menu").addClass("dropdown-menu-pull-right"),angular.element(".nav-tabs-dropdown-menu").removeClass("dropdown-menu-pull-left")):(angular.element(".nav-tabs-dropdown-menu").removeClass("dropdown-menu-pull-right"),angular.element(".nav-tabs-dropdown-menu").addClass("dropdown-menu-pull-left"))}),angular.isArray(j)?h(j):j&&angular.isObject(j)&&angular.isFunction(j.then)?j.then(h,h):h(),f.options.addWidget=f.addWidget,f.options.loadWidgets=f.loadWidgets,f.options.saveDashboard=f.externalSaveDashboard,f.options.removeWidget=f.removeWidget,f.options.openWidgetSettings=f.openWidgetSettings,f.$on("widgetChanged",function(a){a.stopPropagation(),f.saveDashboard()})}}}]),angular.module("ark-dashboard").directive("dashboardLayouts",["LayoutStorage","$timeout","$modal","LayoutMenuObject",function(a,b,c,d){return{scope:!0,templateUrl:function(a,b){return b.templateUrl?b.templateUrl:"src/dashboard/template/dashboard-layouts.html"},link:function(e,f,g){e.widgetLayout=!0,e.options=e.$eval(g.dashboardLayouts);var h=new a(e.options);e.layouts=h.layouts,e.layoutList=new d(e.options.customLayoutDropdownMenu,e.options.customLayoutDropdownActions),e.defaultLayoutActions=[{renameLayout:function(){e.renameLayout()}},{resetWidgetsToDefault:function(){e.resetWidgetsToDefault()}},{saveDashboard:function(){e.options.saveDashboard()}},{removeLayout:function(){e.removeLayout()}}],e.createNewLayout=function(a){var b="widget",c="New Dashboard";a===!0&&(b="expand",c="Expanded Dashboard");var d={title:c,type:b,defaultWidgets:e.options.defaultWidgets||[]};return h.add(d),e._makeLayoutActive(d),h.save(),d},e.removeLayout=function(a){var b=a||h.getActiveLayout();h.remove(b),h.save()},e.makeLayoutActive=function(a){var b=h.getActiveLayout();if(b&&b.dashboard.unsavedChangeCount){var d=c.open({templateUrl:"src/dashboard/template/save-changes-modal.html",resolve:{layout:function(){return a}},controller:"SaveChangesModalCtrl"});d.result.then(function(){e.options.saveDashboard(),e._makeLayoutActive(a)},function(){e._makeLayoutActive(a)})}else e._makeLayoutActive(a)},e._makeLayoutActive=function(a){angular.forEach(e.layouts,function(b){b!==a?b.active=!1:b.active=!0}),h.save()},e.isActive=function(a){return!!a.active},e.renameLayout=function(a){var b=a||h.getActiveLayout(),d=c.open({templateUrl:"src/dashboard/template/rename-template.html",resolve:{title:function(){return b.title},type:function(){return"Dashboard"}},controller:"renameModalCtrl"}),f=b.title;d.result.then(function(a){b.title=a,e._makeLayoutActive(b),e.options.saveDashboard(),e.addTooptip()},function(){b.title=f,e._makeLayoutActive(b)})},e.saveTitleEdit=function(a){a.editingTitle=!1,h.save()},e.options.saveLayouts=function(){h.save(!0)},e.options.addWidget=function(){var a=h.getActiveLayout();a&&a.dashboard.addWidget.apply(a.dashboard,arguments)},e.options.loadWidgets=function(){var a=h.getActiveLayout();a&&a.dashboard.loadWidgets.apply(a.dashboard,arguments)},e.resetWidgetsToDefault=function(){var a=h.getActiveLayout();a.dashboard.loadWidgets(a.defaultWidgets),e.options.saveDashboard()},e.options.saveDashboard=function(){var a=h.getActiveLayout();a&&a.dashboard.saveDashboard.apply(a.dashboard,arguments)},e.addTooptip=function(){b(function(){for(var a=f.find(".tabs-title"),b=0;b<a.length;b++)a[b].offsetWidth<a[b].scrollWidth?e.layouts[b].showTooltip=!0:e.layouts[b].showTooltip=!1})};var i={stop:function(){e.options.saveLayouts()},axis:"x",placeholder:"sortable-placeholder"};e.sortableOptions=angular.extend({},i,e.options.sortableOptions||{})}}}]),angular.module("ark-dashboard"),angular.module("ark-dashboard").directive("expandToTab",function(){return{restrict:"A",templateUrl:function(a,b){return b.templateUrl?b.templateUrl:"src/dashboard/template/expand-to-tab.html"},scope:!0,controller:["$scope","$attrs",function(a,b){a.options=a.$eval(b.expandToTab),a.expand=a.options.defaultWidgets[0]}],link:function(a){a.gridsterOpts={columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[0,0],outerMargin:!0,isMobile:!0,mobileBreakPoint:767,mobileModeEnabled:!1,minColumns:1,minRows:2,maxRows:100,defaultSizeX:6,defaultSizeY:6,minSizeX:6,maxSizeX:6,minSizeY:6,maxSizeY:6,resizable:{enabled:!1},draggable:{enabled:!1}}}}}),angular.module("ark-dashboard").directive("widget",["$injector",function(a){return{controller:"DashboardWidgetCtrl",link:function(b){var c=b.widget,d=c.dataModelType;if(d){var e;if(angular.isFunction(d))e=d;else{if(!angular.isString(d))throw new Error("widget dataModelType should be function or string");a.invoke([d,function(a){e=a}])}var f;f=c.dataModelArgs?new e(c.dataModelArgs):new e,c.dataModel=f,f.setup(c,b),f.init(),b.$on("$destroy",_.bind(f.destroy,f))}b.compileTemplate(),b.$emit("widgetAdded",c)}}}]),angular.module("ark-dashboard").factory("DashboardMenuObject",function(){function a(a,b){var c,d,e={};e.list={},e.actions={};var f={customWidgetMenuList:[{menuLocalizedTitle:"Expand to Tab",menuIcon:"icon-outbound",menuOptionKey:"expandToTab"},{menuLocalizedTitle:"Rename",menuIcon:"icon-24-graph-edit",menuOptionKey:"renameWidget"},{menuLocalizedTitle:"Clone",menuIcon:"icon-clone",menuOptionKey:"clone"},{menuLocalizedTitle:"Delete",menuIcon:"icon-trash",menuOptionKey:"removeWidget"}],customWidgetMenuActions:["expandToTab","renameWidget","clone","removeWidget"]};c=f.customWidgetMenuList,d=f.customWidgetMenuActions;var g=a||{},h=b||{};return e.list=$.merge($.merge([],c),g),e.actions=$.merge($.merge([],d),h),e}return a}),angular.module("ark-dashboard").factory("DashboardState",["$log","$q",function(a,b){function c(a,b,c,d,e){this.storage=a,this.id=b,this.hash=c,this.widgetDefinitions=d,this.stringify=e}return c.prototype={save:function(a){if(!this.storage)return!0;var b=_.map(a,function(a){var b={title:a.title,name:a.name,style:a.style,size:a.size,sizeX:a.sizeX,sizeY:a.sizeY,col:a.col,row:a.row,dataModelOptions:a.dataModelOptions,storageHash:a.storageHash,attrs:a.attrs};return b}),c={widgets:b,hash:this.hash};return this.stringify&&(c=JSON.stringify(c)),this.storage.setItem(this.id,c),!0},load:function(){if(!this.storage)return null;var a;return a=this.storage.getItem(this.id),a?angular.isObject(a)&&angular.isFunction(a.then)?this._handleAsyncLoad(a):this._handleSyncLoad(a):null},_handleSyncLoad:function(b){var c,d=[];if(!b)return null;if(this.stringify)try{c=JSON.parse(b)}catch(e){return a.warn("Serialized dashboard state was malformed and could not be parsed: ",b),null}else c=b;if(c.hash!==this.hash)return a.info("Serialized dashboard from storage was stale (old hash: "+c.hash+", new hash: "+this.hash+")"),this.storage.removeItem(this.id),null;for(var f=c.widgets,g=0;g<f.length;g++){var h=f[g],i=this.widgetDefinitions.getByName(h.name);i?i.hasOwnProperty("storageHash")&&i.storageHash!==h.storageHash?a.info('Widget Definition Object with name "'+h.name+'" was found but the storageHash property on the widget definition is different from that on the serialized widget loaded from storage. hash from storage: "'+h.storageHash+'", hash from WDO: "'+i.storageHash+'"'):d.push(h):a.warn('Widget with name "'+h.name+'" was not found in given widget definition objects')}return d},_handleAsyncLoad:function(a){var c=this,d=b.defer();return a.then(function(a){var b=c._handleSyncLoad(a);b?d.resolve(b):d.reject(b)},function(a){d.reject(a)}),d.promise}},c}]),angular.module("ark-dashboard").factory("ExpandToTabModel",function(){function a(a,b){var c={title:"Expanded Tab",name:a.name,attrs:a.attrs};if(b=b||{},angular.extend(this,angular.copy(c),b),this.containerStyle={width:"100%"},this.contentStyle={},this.updateContainerStyle(this.style),a.templateUrl)this.templateUrl=a.templateUrl;else if(a.template)this.template=a.template;else{var d=a.directive||a.name;this.directive=d}}return a.prototype={updateContainerStyle:function(a){angular.extend(this.containerStyle,a)}},a}),angular.module("ark-dashboard").factory("LayoutMenuObject",function(){function a(a,b){var c,d,e={};e.list={},e.actions={};var f={customLayoutMenuList:[{menuLocalizedTitle:"Rename",menuIcon:"icon-24-graph-edit",menuOptionKey:"renameLayout"},{menuLocalizedTitle:"Reset To Default Dashboard",menuIcon:"icon-reset",menuOptionKey:"resetWidgetsToDefault"},{menuLocalizedTitle:"Set as Default Dashboard",menuIcon:"icon-agent-status-ready",menuOptionKey:"saveDashboard"},{menuLocalizedTitle:"Delete",menuIcon:"icon-trash",menuOptionKey:"removeLayout"}],customLayoutMenuActions:["renameLayout","resetWidgetsToDefault","saveDashboard","removeLayout"]};c=f.customLayoutMenuList,d=f.customLayoutMenuActions;var g=a||{},h=b||{};return e.list=$.merge($.merge([],c),g),e.actions=$.merge($.merge([],d),h),e}return a}),angular.module("ark-dashboard").factory("LayoutStorage",function(){function a(a){var c={storage:b,storageHash:"",stringifyStorage:!0};angular.extend(c,a),angular.extend(a,c),this.id=a.storageId,this.storage=a.storage,this.storageHash=a.storageHash,this.stringifyStorage=a.stringifyStorage,this.widgetDefinitions=a.widgetDefinitions,this.defaultLayouts=a.defaultLayouts,this.lockDefaultLayouts=a.lockDefaultLayouts,this.widgetButtons=a.widgetButtons,this.customWidgetDropdownMenu=a.customWidgetDropdownMenu,this.customWidgetDropdownActions=a.customWidgetDropdownActions,this.customLayoutDropdownMenu=a.customLayoutDropdownMenu,this.customLayoutDropdownActions=a.customLayoutDropdownActions,this.explicitSave=a.explicitSave,this.defaultWidgets=a.defaultWidgets,this.settingsModalOptions=a.settingsModalOptions,this.options=a,this.options.unsavedChangeCount=0,this.layouts=[],this.states={},this.load(),this._ensureActiveLayout()}var b={setItem:function(){},getItem:function(){},removeItem:function(){}};return a.prototype={add:function(a){angular.isArray(a)||(a=[a]);var b=this;angular.forEach(a,function(a){a.dashboard=a.dashboard||{},a.dashboard.storage=b,a.dashboard.storageId=a.id=b._getLayoutId.call(b,a),a.dashboard.widgetDefinitions=b.widgetDefinitions,a.dashboard.stringifyStorage=!1,a.dashboard.defaultWidgets=a.defaultWidgets||b.defaultWidgets,a.dashboard.widgetButtons=b.widgetButtons,a.dashboard.explicitSave=b.explicitSave,a.dashboard.settingsModalOptions=b.settingsModalOptions,a.dashboard.customWidgetDropdownMenu=b.customWidgetDropdownMenu,a.dashboard.customWidgetDropdownActions=b.customWidgetDropdownActions,b.layouts.push(a)})},remove:function(a){var b=this.layouts.indexOf(a);if(b>=0&&(this.layouts.splice(b,1),delete this.states[a.id],a.active&&this.layouts.length)){var c=b>0?b-1:0;this.layouts[c].active=!0}},save:function(){var a={layouts:this._serializeLayouts(),states:this.states,storageHash:this.storageHash};this.stringifyStorage&&(a=JSON.stringify(a)),this.storage.setItem(this.id,a),this.options.unsavedChangeCount=0},load:function(){var a=this.storage.getItem(this.id);this.clear(),a?angular.isObject(a)&&angular.isFunction(a.then)?this._handleAsyncLoad(a):this._handleSyncLoad(a):this._addDefaultLayouts()},clear:function(){this.layouts=[],this.states={}},setItem:function(a,b){this.states[a]=b,this.save()},getItem:function(a){return this.states[a]},removeItem:function(a){delete this.states[a],this.save()},getActiveLayout:function(){for(var a=this.layouts.length,b=0;a>b;b++){var c=this.layouts[b];if(c.active)return c}return!1},_addDefaultLayouts:function(){var a=this,b=this.lockDefaultLayouts?{locked:!0}:{};angular.forEach(this.defaultLayouts,function(c){a.add(angular.extend(_.clone(b),c))})},_serializeLayouts:function(){var a=[];return angular.forEach(this.layouts,function(b){a.push({title:b.title,id:b.id,active:b.active,locked:b.locked,type:b.type,defaultWidgets:b.dashboard.defaultWidgets})}),a},_handleSyncLoad:function(a){var b;if(this.stringifyStorage)try{b=JSON.parse(a)}catch(c){return void this._addDefaultLayouts()}else b=a;return this.storageHash!==b.storageHash?void this._addDefaultLayouts():(this.states=b.states,void this.add(b.layouts))},_handleAsyncLoad:function(a){var b=this;a.then(angular.bind(b,this._handleSyncLoad),angular.bind(b,this._addDefaultLayouts))},_ensureActiveLayout:function(){for(var a=0;a<this.layouts.length;a++){var b=this.layouts[a];if(b.active)return}this.layouts[0]&&(this.layouts[0].active=!0)},_getLayoutId:function(a){if(a.id)return a.id;for(var b=0,c=0;c<this.layouts.length;c++){var d=this.layouts[c].id;b=Math.max(b,1*d)}return b+1}},a}),angular.module("ark-dashboard").factory("WidgetDataModel",function(){function a(){}return a.prototype={setup:function(a,b){this.dataAttrName=a.dataAttrName,this.dataModelOptions=a.dataModelOptions,this.widgetScope=b},updateScope:function(a){this.widgetScope.widgetData=a},init:function(){},destroy:function(){}},a}),angular.module("ark-dashboard").factory("WidgetDefCollection",function(){function a(a){this.push.apply(this,a);var b={};_.each(a,function(a){b[a.name]=a}),this.map=b}return a.prototype=Object.create(Array.prototype),a.prototype.getByName=function(a){return this.map[a]},a}),angular.module("ark-dashboard").factory("WidgetModel",["$log",function(a){function b(a,b){var c={title:"Widget",name:a.name,attrs:a.attrs,dataAttrName:a.dataAttrName,dataModelType:a.dataModelType,dataModelArgs:a.dataModelArgs,dataModelOptions:a.dataModelOptions,settingsModalOptions:a.settingsModalOptions,onSettingsClose:a.onSettingsClose,onSettingsDismiss:a.onSettingsDismiss,style:a.style||{},size:a.size||{},enableVerticalResize:a.enableVerticalResize===!1?!1:!0};if(b=b||{},angular.extend(this,angular.copy(c),b),this.containerStyle={width:"33%"},this.contentStyle={},this.updateContainerStyle(this.style),a.templateUrl)this.templateUrl=a.templateUrl;else if(a.template)this.template=a.template;else{var d=a.directive||a.name;this.directive=d}this.size&&_.has(this.size,"height")&&this.setHeight(this.size.height),this.style&&_.has(this.style,"width")&&this.setWidth(this.style.width),this.size&&_.has(this.size,"width")&&this.setWidth(this.size.width)}return b.prototype={setWidth:function(b,c){return b=b.toString(),c=c||b.replace(/^[-\.\d]+/,"")||"%",this.widthUnits=c,b=parseFloat(b),0>b||isNaN(b)?(a.warn("malhar-angular-dashboard: setWidth was called when width was "+b),!1):("%"===c&&(b=Math.min(100,b),b=Math.max(0,b)),this.containerStyle.width=b+""+c,this.updateSize(this.containerStyle),!0)},setHeight:function(a){this.contentStyle.height=a,this.updateSize(this.contentStyle)},setStyle:function(a){this.style=a,this.updateContainerStyle(a)},updateSize:function(a){angular.extend(this.size,a)},updateContainerStyle:function(a){angular.extend(this.containerStyle,a)}},b}]),angular.module("ark-dashboard").controller("DashboardWidgetCtrl",["$scope","$element","$compile",function(a,b,c){a.status={isopen:!1},a.makeTemplateString=function(){var b=a.widget,c="";return b.templateUrl?c="<div ng-include=\"'"+b.templateUrl+"'\"></div>":b.template?c=b.template:(c="<div "+b.directive,b.dataAttrName&&(b.attrs=b.attrs||{},b.attrs[b.dataAttrName]="widgetData"),b.attrs&&(b.attrs[b.directive]&&(c+='="'+b.attrs[b.directive]+'"'),_.each(b.attrs,function(a,d){d!==b.directive&&(c+=" "+d+'="'+a+'"')})),c+="></div>"),c},a.saveTitleEdit=function(b){b.editingTitle=!1,a.$emit("widgetChanged",b)},a.compileTemplate=function(){var d=a.findWidgetContainer(b),e=a.makeTemplateString(),f=angular.element(e);d.empty(),d.append(f),c(f)(a)},a.findWidgetContainer=function(a){return a.find(".widget-content")}}]),angular.module("ark-dashboard").controller("renameModalCtrl",["$scope","$modalInstance","title","type",function(a,b,c,d){a.title=c||{},"Dashboard"===d?a.type="Dashboard":"Widget"===d&&(a.type="Widget"),a.ok=function(){b.close(a.title)},a.cancel=function(){b.dismiss()}}]),angular.module("ark-dashboard").controller("SaveChangesModalCtrl",["$scope","$modalInstance","layout",function(a,b,c){a.layout=c,a.ok=function(){b.close()},a.cancel=function(){b.dismiss()}}]),function(a){a.module("gridster",[]).constant("gridsterConfig",{columns:6,pushing:!0,floating:!0,swapping:!1,width:"auto",colWidth:"auto",rowHeight:"match",margins:[10,10],outerMargin:!0,isMobile:!1,mobileBreakPoint:600,mobileModeEnabled:!0,minColumns:1,minRows:1,maxRows:100,defaultSizeX:2,defaultSizeY:1,minSizeX:1,maxSizeX:null,minSizeY:1,maxSizeY:null,saveGridItemCalculatedHeightInMobile:!1,resizable:{enabled:!0,handles:["s","e","n","w","se","ne","sw","nw"]},draggable:{enabled:!0,scrollSensitivity:20,scrollSpeed:15}}).controller("GridsterCtrl",["gridsterConfig","$timeout",function(b,c){var d=this;a.extend(this,b),this.resizable=a.extend({},b.resizable||{}),this.draggable=a.extend({},b.draggable||{});var e=!1;this.layoutChanged=function(){e||(e=!0,c(function(){e=!1,d.loaded&&d.floatItemsUp(),d.updateHeight(d.movingItem?d.movingItem.sizeY:0)}))},this.grid=[],this.destroy=function(){this.grid&&(this.grid.length=0,this.grid=null)},this.setOptions=function(b){if(b)if(b=a.extend({},b),b.draggable&&(a.extend(this.draggable,b.draggable),delete b.draggable),b.resizable&&(a.extend(this.resizable,b.resizable),delete b.resizable),a.extend(this,b),this.margins&&2===this.margins.length)for(var c=0,d=this.margins.length;d>c;++c)this.margins[c]=parseInt(this.margins[c],10),isNaN(this.margins[c])&&(this.margins[c]=0);else this.margins=[0,0]},this.canItemOccupy=function(a,b,c){return b>-1&&c>-1&&a.sizeX+c<=this.columns&&a.sizeY+b<=this.maxRows},this.autoSetItemPosition=function(a){for(var b=0;b<this.maxRows;++b)for(var c=0;c<this.columns;++c){var d=this.getItems(b,c,a.sizeX,a.sizeY,a);if(0===d.length&&this.canItemOccupy(a,b,c))return void this.putItem(a,b,c)}throw new Error("Unable to place item!")},this.getItems=function(a,b,c,d,e){var f=[];c&&d||(c=d=1),!e||e instanceof Array||(e=[e]);for(var g=0;d>g;++g)for(var h=0;c>h;++h){var i=this.getItem(a+g,b+h,e);!i||e&&-1!==e.indexOf(i)||-1!==f.indexOf(i)||f.push(i)}return f},this.getBoundingBox=function(a){if(0===a.length)return null;if(1===a.length)return{row:a[0].row,col:a[0].col,sizeY:a[0].sizeY,sizeX:a[0].sizeX};for(var b=0,c=0,d=9999,e=9999,f=0,g=a.length;g>f;++f){var h=a[f];d=Math.min(h.row,d),e=Math.min(h.col,e),b=Math.max(h.row+h.sizeY,b),c=Math.max(h.col+h.sizeX,c)}return{row:d,col:e,sizeY:b-d,sizeX:c-e}},this.removeItem=function(a){for(var b=0,c=this.grid.length;c>b;++b){var d=this.grid[b];if(d){var e=d.indexOf(a);if(-1!==e){d[e]=null;break}}}this.layoutChanged()},this.getItem=function(a,b,c){!c||c instanceof Array||(c=[c]);for(var d=1;a>-1;){for(var e=1,f=b;f>-1;){var g=this.grid[a];if(g){var h=g[f];if(h&&(!c||-1===c.indexOf(h))&&h.sizeX>=e&&h.sizeY>=d)return h}++e,--f}--a,++d}return null},this.putItems=function(a){for(var b=0,c=a.length;c>b;++b)this.putItem(a[b])},this.putItem=function(a,b,c,d){if(("undefined"==typeof b||null===b)&&(b=a.row,c=a.col,"undefined"==typeof b||null===b))return void this.autoSetItemPosition(a);if(this.canItemOccupy(a,b,c)||(c=Math.min(this.columns-a.sizeX,Math.max(0,c)),b=Math.min(this.maxRows-a.sizeY,Math.max(0,b))),null!==a.oldRow&&"undefined"!=typeof a.oldRow){var e=a.oldRow===b&&a.oldColumn===c,f=this.grid[b]&&this.grid[b][c]===a;if(e&&f)return a.row=b,void(a.col=c);var g=this.grid[a.oldRow];g&&g[a.oldColumn]===a&&delete g[a.oldColumn]}a.oldRow=a.row=b,a.oldColumn=a.col=c,this.moveOverlappingItems(a,d),this.grid[b]||(this.grid[b]=[]),this.grid[b][c]=a,this.movingItem===a&&this.floatItemUp(a),this.layoutChanged()},this.swapItems=function(a,b){this.grid[a.row][a.col]=b,this.grid[b.row][b.col]=a;var c=a.row,d=a.col;a.row=b.row,a.col=b.col,b.row=c,b.col=d},this.moveOverlappingItems=function(a,b){b?-1===b.indexOf(a)&&(b=b.slice(0),b.push(a)):b=[a];var c=this.getItems(a.row,a.col,a.sizeX,a.sizeY,b);this.moveItemsDown(c,a.row+a.sizeY,b)},this.moveItemsDown=function(a,b,c){if(a&&0!==a.length){a.sort(function(a,b){return a.row-b.row}),c=c?c.slice(0):[];var d,e,f,g={};for(e=0,f=a.length;f>e;++e){d=a[e];var h=g[d.col];("undefined"==typeof h||d.row<h)&&(g[d.col]=d.row)}for(e=0,f=a.length;f>e;++e){d=a[e];var i=b-g[d.col];this.moveItemDown(d,d.row+i,c),c.push(d)}}},this.moveItemDown=function(a,b,c){if(!(a.row>=b)){for(;a.row<b;)++a.row,this.moveOverlappingItems(a,c);this.putItem(a,a.row,a.col,c)}},this.floatItemsUp=function(){if(this.floating!==!1&&this.grid)for(var a=0,b=this.grid.length;b>a;++a){var c=this.grid[a];if(c)for(var d=0,e=c.length;e>d;++d){var f=c[d];f&&this.floatItemUp(f)}}},this.floatItemUp=function(a){if(this.floating!==!1){for(var b=a.col,c=a.sizeY,d=a.sizeX,e=null,f=null,g=a.row-1;g>-1;){var h=this.getItems(g,b,d,c,a);if(0!==h.length)break;e=g,f=b,--g}null!==e&&this.putItem(a,e,f)}},this.updateHeight=function(a){if(this.grid){var b=this.minRows;a=a||0;for(var c=this.grid.length;c>=0;--c){var d=this.grid[c];if(d)for(var e=0,f=d.length;f>e;++e)d[e]&&(b=Math.max(b,c+a+d[e].sizeY))}this.gridHeight=this.maxRows-b>0?Math.min(this.maxRows,b):Math.max(this.maxRows,b)}},this.pixelsToRows=function(a,b){return b===!0?Math.ceil(a/this.curRowHeight):b===!1?Math.floor(a/this.curRowHeight):Math.round(a/this.curRowHeight)},this.pixelsToColumns=function(a,b){return b===!0?Math.ceil(a/this.curColWidth):b===!1?Math.floor(a/this.curColWidth):Math.round(a/this.curColWidth)},this.unifiedInput=function(a,b,c,d){var e,f,g={},h=function(a){if(Object.keys)return Object.keys(a).length;var b,c=0;for(b in a)++c;return c},i=function(a){for(var b=0,c=0,d=navigator.userAgent.match(/\bMSIE\b/),e=a;null!==e;e=e.offsetParent)d&&(!document.documentMode||document.documentMode<8)&&"relative"===e.currentStyle.position&&e.offsetParent&&"relative"===e.offsetParent.currentStyle.position&&e.offsetLeft===e.offsetParent.offsetLeft?c+=e.offsetTop:(b+=e.offsetLeft,c+=e.offsetTop);return{x:b,y:c}},j=i(a),k=function(e){if("mousemove"!==e.type||0!==h(g)){for(var f=!0,m=e.changedTouches?e.changedTouches:[e],n=0;n<m.length;++n){var o=m[n],p="undefined"!=typeof o.identifier?o.identifier:"undefined"!=typeof o.pointerId?o.pointerId:1;if("undefined"==typeof o.pageX)if(o.pageX=o.offsetX+j.x,o.pageY=o.offsetY+j.y,o.srcElement.offsetParent===a&&document.documentMode&&8===document.documentMode&&"mousedown"===o.type)o.pageX+=o.srcElement.offsetLeft,o.pageY+=o.srcElement.offsetTop;else if(o.srcElement!==a&&!document.documentMode||document.documentMode<8){for(var q=-2,r=-2,s=o.srcElement;null!==s;s=s.parentNode)q+=s.scrollLeft?s.scrollLeft:0,r+=s.scrollTop?s.scrollTop:0;o.pageX=o.clientX+q,o.pageY=o.clientY+r}var t=o.pageX,u=o.pageY;e.type.match(/(start|down)$/i)?(j=i(a),g[p]&&(d&&d({target:e.target,which:e.which,pointerId:p,pageX:t,pageY:u}),delete g[p]),b&&f&&(f=b({target:e.target,which:e.which,pointerId:p,pageX:t,pageY:u})),g[p]={x:t,y:u},a.msSetPointerCapture?a.msSetPointerCapture(p):"mousedown"===e.type&&1===h(g)&&(l?a.setCapture(!0):(document.addEventListener("mousemove",k,!1),document.addEventListener("mouseup",k,!1)))):e.type.match(/move$/i)?!g[p]||g[p].x===t&&g[p].y===u||(c&&f&&(f=c({target:e.target,which:e.which,pointerId:p,pageX:t,pageY:u})),g[p].x=t,g[p].y=u):g[p]&&e.type.match(/(up|end|cancel)$/i)&&(d&&f&&(f=d({target:e.target,which:e.which,pointerId:p,pageX:t,pageY:u})),delete g[p],a.msReleasePointerCapture?a.msReleasePointerCapture(p):"mouseup"===e.type&&0===h(g)&&(l?a.releaseCapture():(document.removeEventListener("mousemove",k,!1),document.removeEventListener("mouseup",k,!1))))}f&&(e.preventDefault&&e.preventDefault(),e.preventManipulation&&e.preventManipulation(),e.preventMouseEvent&&e.preventMouseEvent())}},l=!1;return this.enable=function(){window.navigator.msPointerEnabled?(a.addEventListener("MSPointerDown",k,!1),a.addEventListener("MSPointerMove",k,!1),a.addEventListener("MSPointerUp",k,!1),a.addEventListener("MSPointerCancel",k,!1),"undefined"!=typeof a.style.msContentZooming&&(e=a.style.msContentZooming,a.style.msContentZooming="none"),"undefined"!=typeof a.style.msTouchAction&&(f=a.style.msTouchAction,a.style.msTouchAction="none")):a.addEventListener?(a.addEventListener("touchstart",k,!1),a.addEventListener("touchmove",k,!1),a.addEventListener("touchend",k,!1),a.addEventListener("touchcancel",k,!1),a.addEventListener("mousedown",k,!1),a.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(l=!0,a.addEventListener("mousemove",k,!1),a.addEventListener("mouseup",k,!1))):a.attachEvent&&a.setCapture&&(l=!0,a.attachEvent("onmousedown",function(){return k(window.event),window.event.returnValue=!1,!1}),a.attachEvent("onmousemove",function(){return k(window.event),window.event.returnValue=!1,!1}),a.attachEvent("onmouseup",function(){return k(window.event),window.event.returnValue=!1,!1}))},this.disable=function(){window.navigator.msPointerEnabled?(a.removeEventListener("MSPointerDown",k,!1),a.removeEventListener("MSPointerMove",k,!1),a.removeEventListener("MSPointerUp",k,!1),a.removeEventListener("MSPointerCancel",k,!1),e&&(a.style.msContentZooming=e),f&&(a.style.msTouchAction=f)):a.removeEventListener?(a.removeEventListener("touchstart",k,!1),a.removeEventListener("touchmove",k,!1),a.removeEventListener("touchend",k,!1),a.removeEventListener("touchcancel",k,!1),a.removeEventListener("mousedown",k,!1),a.setCapture&&!window.navigator.userAgent.match(/\bGecko\b/)&&(l=!0,a.removeEventListener("mousemove",k,!1),a.removeEventListener("mouseup",k,!1))):a.detachEvent&&a.setCapture&&(l=!0,a.detachEvent("onmousedown"),a.detachEvent("onmousemove"),a.detachEvent("onmouseup"))},this}}]).directive("gridster",["$timeout","$rootScope","$window",function(b,c,d){return{restrict:"EAC",transclude:!0,replace:!0,template:'<div ng-class="gridsterClass()"><div ng-style="previewStyle()" class="gridster-item gridster-preview-holder"></div><div class="gridster-content" ng-transclude></div></div>',controller:"GridsterCtrl",controllerAs:"gridster",scope:{config:"=?gridster"},compile:function(){return function(e,f,g,h){function i(){var a=f[0].offsetWidth||parseInt(f.css("width"),10);a&&a!==m&&!h.movingItem&&(m=a,h.loaded&&f.removeClass("gridster-loaded"),k(),h.loaded&&f.addClass("gridster-loaded"),e.$parent.$broadcast("gridster-resized",[a,f.offsetHeight]))}function j(){i(),b(function(){e.$apply()})}h.loaded=!1,e.gridsterClass=function(){return{gridster:!0,"gridster-desktop":!h.isMobile,"gridster-mobile":h.isMobile,"gridster-loaded":h.loaded}},e.previewStyle=function(){return h.movingItem?{display:"block",height:h.movingItem.sizeY*h.curRowHeight-h.margins[0]+"px",width:h.movingItem.sizeX*h.curColWidth-h.margins[1]+"px",top:h.movingItem.row*h.curRowHeight+(h.outerMargin?h.margins[0]:0)+"px",left:h.movingItem.col*h.curColWidth+(h.outerMargin?h.margins[1]:0)+"px"}:{display:"none"}};var k=function(){h.setOptions(e.config),"auto"===h.width?h.curWidth=f[0].offsetWidth||parseInt(f.css("width"),10):h.curWidth=h.width,"auto"===h.colWidth?h.curColWidth=(h.curWidth+(h.outerMargin?-h.margins[1]:h.margins[1]))/h.columns:h.curColWidth=h.colWidth,h.curRowHeight=h.rowHeight,"string"==typeof h.rowHeight&&("match"===h.rowHeight?h.curRowHeight=Math.round(h.curColWidth):-1!==h.rowHeight.indexOf("*")?h.curRowHeight=Math.round(h.curColWidth*h.rowHeight.replace("*","").replace(" ","")):-1!==h.rowHeight.indexOf("/")&&(h.curRowHeight=Math.round(h.curColWidth/h.rowHeight.replace("/","").replace(" ","")))),h.isMobile=h.mobileModeEnabled&&h.curWidth<=h.mobileBreakPoint;for(var a=0,b=h.grid.length;b>a;++a){var c=h.grid[a];if(c)for(var d=0,g=c.length;g>d;++d)if(c[d]){var i=c[d];i.setElementPosition(),i.setElementSizeY(),i.setElementSizeX()}}l()};e.$watch("config",k,!0),e.$watch("config.draggable",function(){c.$broadcast("gridster-draggable-changed")},!0),e.$watch("config.resizable",function(){c.$broadcast("gridster-resizable-changed")},!0);var l=function(){f.css("height",h.gridHeight*h.curRowHeight+(h.outerMargin?h.margins[0]:-h.margins[0])+"px")};e.$watch("gridster.gridHeight",l),
e.$watch("gridster.movingItem",function(){h.updateHeight(h.movingItem?h.movingItem.sizeY:0)});var m=f[0].offsetWidth||parseInt(f.css("width"),10);"function"==typeof f.resize&&f.resize(j);var n=a.element(d);n.on("resize",j),e.$watch(function(){return f[0].offsetWidth||parseInt(f.css("width"),10)},i),e.$on("$destroy",function(){h.destroy(),n.off("resize",j)}),b(function(){e.$watch("gridster.floating",function(){h.floatItemsUp()}),h.loaded=!0},100)}}}}]).controller("GridsterItemCtrl",function(){this.$element=null,this.gridster=null,this.row=null,this.col=null,this.sizeX=null,this.sizeY=null,this.minSizeX=0,this.minSizeY=0,this.maxSizeX=null,this.maxSizeY=null,this.init=function(a,b){this.$element=a,this.gridster=b,this.sizeX=b.defaultSizeX,this.sizeY=b.defaultSizeY},this.destroy=function(){this.gridster=null,this.$element=null},this.toJSON=function(){return{row:this.row,col:this.col,sizeY:this.sizeY,sizeX:this.sizeX}},this.isMoving=function(){return this.gridster.movingItem===this},this.setPosition=function(a,b){this.gridster.putItem(this,a,b),this.isMoving()||this.setElementPosition()},this.setSize=function(a,b,c){a=a.toUpperCase();var d="size"+a,e="Size"+a;if(""!==b){b=parseInt(b,10),(isNaN(b)||0===b)&&(b=this.gridster["default"+e]);var f="X"===a?this.gridster.columns:this.gridster.maxRows;this["max"+e]&&(f=Math.min(this["max"+e],f)),this.gridster["max"+e]&&(f=Math.min(this.gridster["max"+e],f)),"X"===a&&this.cols?f-=this.cols:"Y"===a&&this.rows&&(f-=this.rows);var g=0;this["min"+e]&&(g=Math.max(this["min"+e],g)),this.gridster["min"+e]&&(g=Math.max(this.gridster["min"+e],g)),b=Math.max(Math.min(b,f),g);var h=this[d]!==b||this["old"+e]&&this["old"+e]!==b;return this["old"+e]=this[d]=b,this.isMoving()||this["setElement"+e](),!c&&h&&(this.gridster.moveOverlappingItems(this),this.gridster.layoutChanged()),h}},this.setSizeY=function(a,b){return this.setSize("Y",a,b)},this.setSizeX=function(a,b){return this.setSize("X",a,b)},this.setElementPosition=function(){this.$element.css(this.gridster.isMobile?{marginLeft:this.gridster.margins[0]+"px",marginRight:this.gridster.margins[0]+"px",marginTop:this.gridster.margins[1]+"px",marginBottom:this.gridster.margins[1]+"px",top:"",left:""}:{margin:0,top:this.row*this.gridster.curRowHeight+(this.gridster.outerMargin?this.gridster.margins[0]:0)+"px",left:this.col*this.gridster.curColWidth+(this.gridster.outerMargin?this.gridster.margins[1]:0)+"px"})},this.setElementSizeY=function(){this.gridster.isMobile&&!this.gridster.saveGridItemCalculatedHeightInMobile?this.$element.css("height",""):this.$element.css("height",this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]+"px")},this.setElementSizeX=function(){this.gridster.isMobile?this.$element.css("width",""):this.$element.css("width",this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]+"px")},this.getElementSizeX=function(){return this.sizeX*this.gridster.curColWidth-this.gridster.margins[1]},this.getElementSizeY=function(){return this.sizeY*this.gridster.curRowHeight-this.gridster.margins[0]}}).factory("GridsterDraggable",["$document","$timeout","$window",function(b,c,d){function e(e,f,g,h,i){function j(b){if(-1!==G.indexOf(b.target.nodeName.toLowerCase()))return!1;if(a.element(b.target).hasClass("gridster-item-resizable-handler"))return!1;if(a.element(b.target).attr("onclick")||a.element(b.target).attr("ng-click"))return!1;switch(b.which){case 1:break;case 2:case 3:return}return y=b.pageX,z=b.pageY,p=parseInt(e.css("left"),10),q=parseInt(e.css("top"),10),r=e[0].offsetWidth,s=e[0].offsetHeight,t=h.col,u=h.row,m(b),!0}function k(a){if(!e.hasClass("gridster-item-moving")||e.hasClass("gridster-item-resizing"))return!1;var b=g.curWidth-1;w=a.pageX,x=a.pageY;var c=w-y+A,d=x-z+B;A=B=0,y=w,z=x;var f=c,h=d;return E>p+f?(c=E-p,A=f-c):p+r+f>b&&(c=b-p-r,A=f-c),C>q+h?(d=C-q,B=h-d):q+s+h>D&&(d=D-q-s,B=h-d),p+=c,q+=d,e.css({top:q+"px",left:p+"px"}),n(a),!0}function l(a){return!e.hasClass("gridster-item-moving")||e.hasClass("gridster-item-resizing")?!1:(A=B=0,o(a),!0)}function m(a){e.addClass("gridster-item-moving"),g.movingItem=h,g.updateHeight(h.sizeY),f.$apply(function(){g.draggable&&g.draggable.start&&g.draggable.start(a,e,i)})}function n(a){var b=h.row,c=h.col,j=g.draggable&&g.draggable.drag,k=g.draggable.scrollSensitivity,l=g.draggable.scrollSpeed,m=g.pixelsToRows(q),n=g.pixelsToColumns(p),o=g.getItems(m,n,h.sizeX,h.sizeY,h),r=0!==o.length;if(g.swapping===!0&&r){var s=g.getBoundingBox(o),t=s.sizeX===h.sizeX&&s.sizeY===h.sizeY,u=s.row===m,v=s.col===n,w=u&&v,x=u||v;if(t&&1===o.length){if(w)g.swapItems(h,o[0]);else if(x)return}else if(s.sizeX<=h.sizeX&&s.sizeY<=h.sizeY&&x)for(var y=h.row<=m?h.row:m+h.sizeY,z=h.col<=n?h.col:n+h.sizeX,A=y-s.row,B=z-s.col,C=0,D=o.length;D>C;++C){var E=o[C],G=g.getItems(E.row+A,E.col+B,E.sizeX,E.sizeY,h);0===G.length&&g.putItem(E,E.row+A,E.col+B)}}g.pushing===!1&&r||(h.row=m,h.col=n),a.pageY-F.body.scrollTop<k?F.body.scrollTop=F.body.scrollTop-l:d.innerHeight-(a.pageY-F.body.scrollTop)<k&&(F.body.scrollTop=F.body.scrollTop+l),a.pageX-F.body.scrollLeft<k?F.body.scrollLeft=F.body.scrollLeft-l:d.innerWidth-(a.pageX-F.body.scrollLeft)<k&&(F.body.scrollLeft=F.body.scrollLeft+l),(j||b!==h.row||c!==h.col)&&f.$apply(function(){j&&g.draggable.drag(a,e,i)})}function o(a){e.removeClass("gridster-item-moving");var b=g.pixelsToRows(q),c=g.pixelsToColumns(p);(g.pushing!==!1||0===g.getItems(b,c,h.sizeX,h.sizeY,h).length)&&(h.row=b,h.col=c),g.movingItem=null,h.setPosition(h.row,h.col),f.$apply(function(){g.draggable&&g.draggable.stop&&g.draggable.stop(a,e,i)})}var p,q,r,s,t,u,v,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=9999,E=0,F=b[0],G=["select","input","textarea","button"],H=!1,I=null;this.enable=function(){var b=this;c(function(){b.disable(),g.draggable&&g.draggable.handle?(I=a.element(e[0].querySelector(g.draggable.handle)),0===I.length&&(I=e)):I=e,v=new g.unifiedInput(I[0],j,k,l),v.enable(),H=!0})},this.disable=function(){H&&(v.disable(),v=void 0,H=!1)},this.toggle=function(a){a?this.enable():this.disable()},this.destroy=function(){this.disable()}}return e}]).factory("GridsterResizable",[function(){function b(b,c,d,e,f){function g(g){function h(a){switch(a.which){case 1:break;case 2:case 3:return}return t=d.draggable.enabled,t&&(d.draggable.enabled=!1,c.$broadcast("gridster-draggable-changed")),y=a.pageX,z=a.pageY,n=parseInt(b.css("left"),10),o=parseInt(b.css("top"),10),p=b[0].offsetWidth,q=b[0].offsetHeight,r=e.sizeX,s=e.sizeY,i(a),!0}function i(a){b.addClass("gridster-item-moving"),b.addClass("gridster-item-resizing"),d.movingItem=e,e.setElementSizeX(),e.setElementSizeY(),e.setElementPosition(),d.updateHeight(1),c.$apply(function(){d.resizable&&d.resizable.start&&d.resizable.start(a,b,f)})}function j(a){c.$broadcast("gridster-draggable-item-resizing");var e=d.curWidth-1;w=a.pageX,x=a.pageY;var f=w-y+A,g=x-z+B;A=B=0,y=w,z=x;var h=g,i=f;return v.indexOf("n")>=0&&(q-h<F()?(g=q-F(),B=h-g):C>o+h&&(g=C-o,B=h-g),o+=g,q-=g),v.indexOf("s")>=0&&(q+h<F()?(g=F()-q,B=h-g):o+q+h>D&&(g=D-o-q,B=h-g),q+=g),v.indexOf("w")>=0&&(p-i<G()?(f=p-G(),A=i-f):E>n+i&&(f=E-n,A=i-f),n+=f,p-=f),v.indexOf("e")>=0&&(p+i<G()?(f=G()-p,A=i-f):n+p+i>e&&(f=e-n-p,A=i-f),p+=f),b.css({top:o+"px",left:n+"px",width:p+"px",height:q+"px"}),l(a),!0}function k(a){return d.draggable.enabled!==t&&(d.draggable.enabled=t,c.$broadcast("gridster-draggable-changed")),A=B=0,m(a),!0}function l(a){var h=e.row,i=e.col,j=e.sizeX,k=e.sizeY,l=d.resizable&&d.resizable.resize,m=e.col;-1!==["w","nw","sw"].indexOf(g)&&(m=d.pixelsToColumns(n,!1));var r=e.row;-1!==["n","ne","nw"].indexOf(g)&&(r=d.pixelsToRows(o,!1));var s=e.sizeX;-1===["n","s"].indexOf(g)&&(s=d.pixelsToColumns(p,!0));var t=e.sizeY;-1===["e","w"].indexOf(g)&&(t=d.pixelsToRows(q,!0)),(d.pushing!==!1||0===d.getItems(r,m,s,t,e).length)&&(e.row=r,e.col=m,e.sizeX=s,e.sizeY=t);var u=e.row!==h||e.col!==i||e.sizeX!==j||e.sizeY!==k;(l||u)&&c.$apply(function(){l&&d.resizable.resize(a,b,f)})}function m(a){b.removeClass("gridster-item-moving"),b.removeClass("gridster-item-resizing"),d.movingItem=null,e.setPosition(e.row,e.col),e.setSizeY(e.sizeY),e.setSizeX(e.sizeX),c.$apply(function(){d.resizable&&d.resizable.stop&&d.resizable.stop(a,b,f)})}var n,o,p,q,r,s,t,u,v=g,w=0,x=0,y=0,z=0,A=0,B=0,C=0,D=9999,E=0,F=function(){return d.curRowHeight-d.margins[0]},G=function(){return d.curColWidth-d.margins[1]},H=null;this.enable=function(){H||(H=a.element('<div class="gridster-item-resizable-handler handle-'+v+'"></div>'),b.append(H)),u=new d.unifiedInput(H[0],h,j,k),u.enable()},this.disable=function(){H&&(H.remove(),H=null),u.disable(),u=void 0},this.destroy=function(){this.disable()}}var h=[],i=d.resizable.handles;"string"==typeof i&&(i=d.resizable.handles.split(","));for(var j=!1,k=0,l=i.length;l>k;k++)h.push(new g(i[k]));this.enable=function(){if(!j){for(var a=0,b=h.length;b>a;a++)h[a].enable();j=!0}},this.disable=function(){if(j){for(var a=0,b=h.length;b>a;a++)h[a].disable();j=!1}},this.toggle=function(a){a?this.enable():this.disable()},this.destroy=function(){for(var a=0,b=h.length;b>a;a++)h[a].destroy()}}return b}]).directive("gridsterItem",["$parse","GridsterDraggable","GridsterResizable",function(a,b,c){return{restrict:"EA",controller:"GridsterItemCtrl",require:["^gridster","gridsterItem"],link:function(d,e,f,g){function h(){n.setPosition(n.row,n.col),q.row&&q.row.assign&&q.row.assign(d,n.row),q.col&&q.col.assign&&q.col.assign(d,n.col)}function i(){var a=n.setSizeX(n.sizeX,!0);a&&q.sizeX&&q.sizeX.assign&&q.sizeX.assign(d,n.sizeX);var b=n.setSizeY(n.sizeY,!0);b&&q.sizeY&&q.sizeY.assign&&q.sizeY.assign(d,n.sizeY),(a||b)&&(n.gridster.moveOverlappingItems(n),m.layoutChanged())}function j(){var a=document.createElement("div"),b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var c in b)if(void 0!==a.style[c])return b[c]}var k,l=f.gridsterItem,m=g[0],n=g[1];if(l){var o=a(l);k=o(d)||{},!k&&o.assign&&(k={row:n.row,col:n.col,sizeX:n.sizeX,sizeY:n.sizeY,minSizeX:0,minSizeY:0,maxSizeX:null,maxSizeY:null},o.assign(d,k))}else k=f;n.init(e,m),e.addClass("gridster-item");for(var p=["minSizeX","maxSizeX","minSizeY","maxSizeY","sizeX","sizeY","row","col"],q={},r=function(b){var c;if("string"==typeof k[b])c=k[b];else if("string"==typeof k[b.toLowerCase()])c=k[b.toLowerCase()];else{if(!l)return;c=a(l+"."+b)}q[b]=a(c),d.$watch(c,function(a){a=parseInt(a,10),isNaN(a)||(n[b]=a)});var e=q[b](d);"number"==typeof e&&(n[b]=e)},s=0,t=p.length;t>s;++s)r(p[s]);d.$broadcast("gridster-item-initialized",[n.sizeY,n.sizeX,n.getElementSizeY(),n.getElementSizeX()]),d.$watch(function(){return n.row+","+n.col},h),d.$watch(function(){return n.sizeY+","+n.sizeX+"|"+n.minSizeX+","+n.maxSizeX+","+n.minSizeY+","+n.maxSizeY},i);var u=new b(e,d,m,n,k),v=new c(e,d,m,n,k);return d.$on("gridster-draggable-changed",function(){u.toggle(!m.isMobile&&m.draggable&&m.draggable.enabled)}),d.$on("gridster-resizable-changed",function(){v.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled)}),d.$on("gridster-resized",function(){v.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled)}),d.$watch(function(){return m.isMobile},function(){v.toggle(!m.isMobile&&m.resizable&&m.resizable.enabled),u.toggle(!m.isMobile&&m.draggable&&m.draggable.enabled)}),e.on(j(),function(){d.$apply(function(){d.$broadcast("gridster-item-transition-end")})}),d.$on("$destroy",function(){try{v.destroy(),u.destroy()}catch(a){}try{m.removeItem(n)}catch(a){}try{n.destroy()}catch(a){}})}}}])}(angular),angular.module("ark-dashboard").directive("dropdownMenu",function(){return{restrict:"A",templateUrl:function(){return"src/dashboard/components/dropdown-menu/dropdown-menu.html"},scope:{menu:"=",layoutActions:"=",defaultLayoutActions:"=",widgetActions:"=",defaultWidgetActions:"=",widget:"="}}}).controller("dropdownMenuController",["$scope",function(a){a.handleMenuOption=function(b){if(a.layoutActions)for(var c=0;c<a.layoutActions.length;c++){var d=a.layoutActions[c];for(var e in d)if(b===e){var f=d[e];"function"==typeof f&&f()}if("string"==typeof d&&b===d){var g=a.defaultLayoutActions[c],h=g[d];h()}}if(a.widgetActions)for(var i=0;i<a.widgetActions.length;i++){var j=a.widgetActions[i];for(var k in j)if(b===k){var l=j[k];"function"==typeof l&&l(a.widget)}if("string"==typeof j&&b===j){var m=a.defaultWidgetActions[i],n=m[j];n(a.widget)}}}}]).directive("selectText",["$timeout",function(a){return{scope:{trigger:"@focus"},link:function(b,c){b.$watch("trigger",function(){a(function(){c.select()})})}}}]),function(){function a(a){var b=this;b.stc=a}function b(a){var b=this;b.stc=a}function c(a){var b=this;b.stc=a}function d(d,e,f){var g=this;g.$tabsContainer=e,g.$timeout=f,g.scope=d,g.movableContainerLeftPos=0,g.scrollArrowsVisible=!0,g.scrollMovement=new c(g),g.eventHandlers=new a(g),g.elementsHandler=new b(g)}function e(a,b){function c(a){return b.trustAsHtml(a)}return{restrict:"E",template:h,transclude:!1,replace:!0,scope:{tabs:"@",propPaneId:"@",propTitle:"@",propActive:"@",propDisabled:"@",localTabClick:"&tabClick"},link:function(b,e){var f=new d(b,e,a);b.tabsArr=b.$eval(b.tabs),b.propPaneId=b.propPaneId||"paneId",b.propTitle=b.propTitle||"title",b.propActive=b.propActive||"active",b.propDisabled=b.propDisabled||"disabled",b.sanitize=c,e.on("click.scrollingTabs",".nav-tabs > li",function(a){var c=jQuery(this).data();b.localTabClick({$event:a,$index:c.index,tab:c.tab})}),f.initTabs(!1)}}}function f(a){return{restrict:"A",template:i,transclude:!0,replace:!0,link:function(b,c){var e=new d(b,c,a);e.initTabs(!0)}}}var g={CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL:50,SCROLL_OFFSET_FRACTION:6,DATA_KEY_IS_MOUSEDOWN:"ismousedown"},h=['<div class="scrtabs-tab-container">',' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-left"><span class="fonticon  icon-chevron-small-left scr-arrow-left"></span></div>','   <div class="scrtabs-tabs-fixed-container">','     <div class="scrtabs-tabs-movable-container">','       <ul class="nav nav-tabs" role="tablist">',"         <li ng-class=\"{ 'active': tab[propActive || 'active'], ","                         'disabled': tab[propDisabled || 'disabled'] }\" ",'             data-tab="{{tab}}" data-index="{{$index}}" ng-repeat="tab in tabsArr">',"           <a ng-href=\"{{'#' + tab[propPaneId || 'paneId']}}\" role=\"tab\"","                data-toggle=\"{{tab[propDisabled || 'disabled'] ? '' : 'tab'}}\" ","                ng-bind-html=\"sanitize(tab[propTitle || 'title']);\">","           </a>","         </li>","       </ul>","     </div>"," </div>",' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-right"><span class="fonticon icon-chevron-small-right scr-arrow-right"></span></div>',"</div>"].join(""),i=['<div class="scrtabs-tab-container">',' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-left"><span class="fonticon icon-chevron-small-left scr-arrow-left"></span></div>','   <div class="scrtabs-tabs-fixed-container">','     <div class="scrtabs-tabs-movable-container" ng-transclude></div>',"   </div>",' <div class="scrtabs-tab-scroll-arrow scrtabs-js-tab-scroll-arrow-right"><span class="fonticon icon-chevron-small-right scr-arrow-right"></span></div>',"</div>"].join("");!function(a,b){var c=function(a,b,c){var d;return function(){function e(){c||a.apply(f,g),d=null}var f=this,g=arguments;d?clearTimeout(d):c&&a.apply(f,g),d=setTimeout(e,b||100)}};jQuery.fn[b]=function(a){return a?this.bind("resize.scrtabs",c(a)):this.trigger(b)}}(jQuery,"smartresize"),function(a){a.handleClickOnLeftScrollArrow=function(){var a=this,b=a.stc;b.scrollMovement.incrementScrollLeft()},a.handleClickOnRightScrollArrow=function(){var a=this,b=a.stc,c=b.scrollMovement;c.incrementScrollRight(c.getMinPos())},a.handleMousedownOnLeftScrollArrow=function(){var a=this,b=a.stc;b.scrollMovement.startScrollLeft()},a.handleMousedownOnRightScrollArrow=function(){var a=this,b=a.stc;b.scrollMovement.startScrollRight()},a.handleMouseupOnLeftScrollArrow=function(){var a=this,b=a.stc;b.scrollMovement.stopScrollLeft()},a.handleMouseupOnRightScrollArrow=function(){var a=this,b=a.stc;b.scrollMovement.stopScrollRight()},a.handleWindowResize=function(){var a=this,b=a.stc,c=b.$win.width();return c===b.winWidth?!1:(b.winWidth=c,void b.elementsHandler.refreshAllElementSizes(!0))},a.addtab=function(){var a=this,b=a.stc;b.elementsHandler.setMovableContainerWidth(),b.elementsHandler.setScrollArrowVisibility(),b.scrollMovement.startScrollRight()},a.removetab=function(){var a=this,b=a.stc;b.elementsHandler.setMovableContainerWidth(),b.elementsHandler.setScrollArrowVisibility(),b.scrollMovement.incrementScrollLeft()}}(a.prototype),function(a){a.initElements=function(a){var b=this;b.setElementReferences(),a&&b.moveTabContentOutsideScrollContainer(),b.setEventListeners()},a.moveTabContentOutsideScrollContainer=function(){var a=this,b=a.stc,c=b.$tabsContainer;c.find(".tab-content").appendTo(c)},a.refreshAllElementSizes=function(a){var b,c=this,d=c.stc,e=d.scrollMovement,f=d.scrollArrowsVisible;c.setElementWidths(),c.setScrollArrowVisibility(),d.scrollArrowsVisible&&c.setFixedContainerWidthForJustVisibleScrollArrows(),a&&(d.scrollArrowsVisible||f)&&(d.scrollArrowsVisible?(b=e.getMinPos(),d.movableContainerLeftPos<b?e.incrementScrollRight(b):e.scrollToActiveTab(!0)):(d.movableContainerLeftPos=0,e.slideMovableContainerToLeftPos()))},a.setElementReferences=function(){var a=this,b=a.stc,c=b.$tabsContainer;b.$fixedContainer=c.find(".scrtabs-tabs-fixed-container"),b.$movableContainer=c.find(".scrtabs-tabs-movable-container"),b.$tabsUl=c.find(".tabs-item"),b.$tabsUlActive=c.find(".nav-tabs"),b.$leftScrollArrow=c.find(".scrtabs-js-tab-scroll-arrow-left"),b.$rightScrollArrow=c.find(".scrtabs-js-tab-scroll-arrow-right"),b.$scrollArrows=b.$leftScrollArrow.add(b.$rightScrollArrow),b.$win=jQuery(window)},a.setElementWidths=function(){var a=this,b=a.stc;b.containerWidth=b.$tabsContainer.outerWidth(),b.winWidth=b.$win.width(),b.scrollArrowsCombinedWidth=b.$leftScrollArrow.outerWidth()+b.$rightScrollArrow.outerWidth(),a.setFixedContainerWidth(),a.setMovableContainerWidth()},a.setEventListeners=function(){var a=this,b=a.stc,c=b.eventHandlers;b.$leftScrollArrow.on({"mousedown.scrtabs":function(a){c.handleMousedownOnLeftScrollArrow.call(c,a)},"mouseup.scrtabs":function(a){c.handleMouseupOnLeftScrollArrow.call(c,a)},"click.scrtabs":function(a){c.handleClickOnLeftScrollArrow.call(c,a)}}),b.$rightScrollArrow.on({"mousedown.scrtabs":function(a){c.handleMousedownOnRightScrollArrow.call(c,a)},"mouseup.scrtabs":function(a){c.handleMouseupOnRightScrollArrow.call(c,a)},"click.scrtabs":function(a){c.handleClickOnRightScrollArrow.call(c,a)}}),b.$win.smartresize(function(a){c.handleWindowResize.call(c,a)}),b.scope.$watch(function(){return angular.element(".tabs-item").length},function(a,b){a>b?c.addtab.call(c):b>a&&c.removetab.call(c)})},a.setFixedContainerWidth=function(){var a=this,b=a.stc;b.$fixedContainer.width(b.fixedContainerWidth=b.$tabsContainer.outerWidth())},a.setFixedContainerWidthForJustHiddenScrollArrows=function(){var a=this,b=a.stc;b.$fixedContainer.width(b.fixedContainerWidth)},a.setFixedContainerWidthForJustVisibleScrollArrows=function(){var a=this,b=a.stc;b.$fixedContainer.width(b.fixedContainerWidth-b.scrollArrowsCombinedWidth)},a.setMovableContainerWidth=function(){var a=this,b=a.stc;b.movableContainerWidth=50,angular.element(".tabs-item").each(function(){var a=jQuery(this);b.movableContainerWidth+=a.outerWidth()}),b.$movableContainer.width(b.movableContainerWidth+=1)},a.setScrollArrowVisibility=function(){var a=this,b=a.stc,c=b.movableContainerWidth>b.fixedContainerWidth;c&&angular.element(".tabs-add-button").addClass("fixed-add-button"),c&&!b.scrollArrowsVisible?(b.$scrollArrows.show(),b.scrollArrowsVisible=!0,a.setFixedContainerWidthForJustVisibleScrollArrows()):!c&&b.scrollArrowsVisible&&(angular.element(".tabs-add-button").removeClass("fixed-add-button"),b.scrollMovement.incrementScrollLeft(),b.$scrollArrows.hide(),b.scrollArrowsVisible=!1,a.setFixedContainerWidthForJustHiddenScrollArrows())}}(b.prototype),function(a){a.continueScrollLeft=function(){var a=this,b=a.stc;b.$timeout(function(){b.$leftScrollArrow.data(g.DATA_KEY_IS_MOUSEDOWN)&&b.movableContainerLeftPos<0&&(a.incrementScrollLeft()||a.continueScrollLeft())},g.CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL)},a.continueScrollRight=function(a){var b=this,c=b.stc;c.$timeout(function(){c.$rightScrollArrow.data(g.DATA_KEY_IS_MOUSEDOWN)&&c.movableContainerLeftPos>a&&(b.incrementScrollRight(a)||b.continueScrollRight(a))},g.CONTINUOUS_SCROLLING_TIMEOUT_INTERVAL)},a.decrementMovableContainerLeftPos=function(a){var b=this,c=b.stc;c.movableContainerLeftPos-=c.fixedContainerWidth/g.SCROLL_OFFSET_FRACTION,c.movableContainerLeftPos<a&&(c.movableContainerLeftPos=a)},a.getMinPos=function(){var a=this,b=a.stc;return b.scrollArrowsVisible?b.fixedContainerWidth-b.movableContainerWidth-b.scrollArrowsCombinedWidth:0},a.getMovableContainerCssLeftVal=function(){var a=this,b=a.stc;return 0===b.movableContainerLeftPos?"0":b.movableContainerLeftPos+"px"},a.incrementScrollLeft=function(){var a=this,b=a.stc;return b.movableContainerLeftPos+=b.fixedContainerWidth/g.SCROLL_OFFSET_FRACTION,b.movableContainerLeftPos>0&&(b.movableContainerLeftPos=0),a.slideMovableContainerToLeftPos(),0===b.movableContainerLeftPos},a.incrementScrollRight=function(a){var b=this,c=b.stc;return b.decrementMovableContainerLeftPos(a),b.slideMovableContainerToLeftPos(),c.movableContainerLeftPos===a},a.scrollToActiveTab=function(a){var b,c,d,e,f,g=this,h=g.stc;h.scrollArrowsVisible&&(b=h.$tabsUlActive.find("li.active"),b.length&&(c=b.outerWidth(),d=b.offset().left,e=h.$rightScrollArrow.offset().left,f=d+c-e,f>0&&(h.movableContainerLeftPos=a?h.movableContainerLeftPos-f:-f,g.slideMovableContainerToLeftPos())))},a.slideMovableContainerToLeftPos=function(){var a,b=this,c=b.stc;c.movableContainerLeftPos=c.movableContainerLeftPos/1,a=b.getMovableContainerCssLeftVal(),c.$movableContainer.stop().animate({left:a},"slow",function(){var a=b.getMinPos();c.movableContainerLeftPos<a&&(b.decrementMovableContainerLeftPos(a),c.$movableContainer.stop().animate({left:b.getMovableContainerCssLeftVal()},"fast"))})},a.startScrollLeft=function(){var a=this,b=a.stc;b.$leftScrollArrow.data(g.DATA_KEY_IS_MOUSEDOWN,!0),a.continueScrollLeft()},a.startScrollRight=function(){var a=this,b=a.stc;b.$rightScrollArrow.data(g.DATA_KEY_IS_MOUSEDOWN,!0),a.continueScrollRight(a.getMinPos())},a.stopScrollLeft=function(){var a=this,b=a.stc;b.$leftScrollArrow.data(g.DATA_KEY_IS_MOUSEDOWN,!1)},a.stopScrollRight=function(){var a=this,b=a.stc;b.$rightScrollArrow.data(g.DATA_KEY_IS_MOUSEDOWN,!1)}}(c.prototype),function(a){a.initTabs=function(a){var b=this,c=b.elementsHandler,d=b.scrollMovement;b.$timeout(function(){c.initElements(a),c.refreshAllElementSizes(),c.setScrollArrowVisibility(),d.scrollToActiveTab()},100)}}(d.prototype),e.$inject=["$timeout","$sce"],f.$inject=["$timeout"],angular.module("ark-dashboard").directive("scrollingTabs",e),angular.module("ark-dashboard").directive("scrollingTabsWrapper",f)}(),angular.module("ark-dashboard").controller("widgetChart",function(a){a.$on("gridster-draggable-item-resizing",function(){a.$$childTail.api.update()})}),function(){angular.module("nvd3",[]).directive("nvd3",["utils",function(a){return{restrict:"AE",scope:{data:"=",options:"=",api:"=?",events:"=?",config:"=?",chartType:"="},link:function(b,c){function d(a,c){a&&c&&angular.forEach(a,function(d,f){"dispatch"===f?((void 0===c[f]||null===c[f])&&b._config.extended&&(c[f]={}),e(d,c[f])):["scatter","defined","options","axis","rangeBand","rangeBands","_options","_inherited","_d3options","_calls"].indexOf(f)<0&&(void 0===c[f]||null===c[f]?b._config.extended&&(c[f]=d()):a[f](c[f]))})}function e(a,c){a&&c&&angular.forEach(a,function(d,e){void 0===c[e]||null===c[e]?b._config.extended&&(c[e]=d.on):a.on(e+"._",c[e])})}function f(d){var e=a.deepExtend(h(d),b.options[d]||{});b._config.extended&&(b.options[d]=e);var f=angular.element("<div></div>").html(e.html||"").addClass(d).addClass(e["class"]).removeAttr("style").css(e.css);e.html||f.text(e.text),e.enable&&("title"===d?c.prepend(f):"subtitle"===d?c.find(".title").after(f):"caption"===d&&c.append(f))}function g(){var d=a.deepExtend(i(),b.options.styles||{});b._config.extended&&(b.options.styles=d),angular.forEach(d.classes,function(a,b){a?c.addClass(b):c.removeClass(b)}),c.removeAttr("style").css(d.css)}function h(a){switch(a){case"title":return{enable:!1,text:"Write Your Title","class":"h4",css:{width:b.options.chart.width+"px",textAlign:"center"}};case"subtitle":return{enable:!1,text:"Write Your Subtitle",css:{width:b.options.chart.width+"px",textAlign:"center"}};case"caption":return{enable:!1,text:"Figure 1. Write Your Caption text.",css:{width:b.options.chart.width+"px",textAlign:"center"}}}}function i(){return{classes:{"with-3d-shadow":!0,"with-transitions":!0,gallery:!1},css:{}}}var j={extended:!1,visible:!0,disabled:!1,autorefresh:!0,refreshDataOnly:!1,deepWatchData:!0,debounce:10};b._config=angular.extend(j,b.config),b.api={refresh:function(){b.api.updateWithOptions(b.options)},update:function(){b.chart.update()},updateWithOptions:function(a){b.api.clearElement(),angular.isDefined(a)!==!1&&b._config.visible&&(b.chart=nv.models[a.chart.type](),b.chart.id=Math.random().toString(36).substr(2,15),angular.forEach(b.chart,function(c,f){["options","_options","_inherited","_d3options","state","id","resizeHandler"].indexOf(f)>=0||("dispatch"===f?((void 0===a.chart[f]||null===a.chart[f])&&b._config.extended&&(a.chart[f]={}),e(b.chart[f],a.chart[f])):["lines","lines1","lines2","bars","bars1","bars2","stack1","stack2","stacked","multibar","discretebar","pie","scatter","bullet","sparkline","legend","distX","distY","xAxis","x2Axis","yAxis","yAxis1","yAxis2","y1Axis","y2Axis","y3Axis","y4Axis","interactiveLayer","controls"].indexOf(f)>=0?((void 0===a.chart[f]||null===a.chart[f])&&b._config.extended&&(a.chart[f]={}),d(b.chart[f],a.chart[f],a.chart.type)):("xTickFormat"!==f&&"yTickFormat"!==f||"lineWithFocusChart"!==a.chart.type)&&(void 0===a.chart[f]||null===a.chart[f]?b._config.extended&&(a.chart[f]=c()):b.chart[f](a.chart[f])))}),b.api.updateWithData(b.data),(a.title||b._config.extended)&&f("title"),(a.subtitle||b._config.extended)&&f("subtitle"),(a.caption||b._config.extended)&&f("caption"),(a.styles||b._config.extended)&&g(),nv.addGraph(function(){return b.chart.resizeHandler=nv.utils.windowResize(function(){b.chart.update()}),b.chart},a.chart.callback))},updateWithData:function(a){a&&(b.options.chart.transitionDuration=+b.options.chart.transitionDuration||250,d3.select(c[0]).select("svg").remove(),d3.select(c[0]).append("svg").attr("height",b.options.chart.height).attr("width",b.options.chart.width||"100%").datum(a).transition().duration(b.options.chart.transitionDuration).call(b.chart))},clearElement:function(){if(c.find(".title").remove(),c.find(".subtitle").remove(),c.find(".caption").remove(),c.empty(),b.chart){b.chart.resizeHandler&&b.chart.resizeHandler.clear();for(var a=0;a<nv.graphs.length;a++)nv.graphs[a].id===b.chart.id&&nv.graphs.splice(a,1)}b.chart=null,nv.tooltip.cleanup()},getScope:function(){return b}},b.$watch("options",a.debounce(function(){!b._config.disabled&&b._config.autorefresh&&b.api.refresh()},b._config.debounce,!0),!0),b.$watch("data",function(a,c){a!==c&&b.chart&&!b._config.disabled&&b._config.autorefresh&&(b._config.refreshDataOnly?b.chart.update():b.api.refresh())},b._config.deepWatchData),b.$watch("config",function(a,c){a!==c&&(b._config=angular.extend(j,a),b.api.refresh())},!0),angular.forEach(b.events,function(a,c){b.$on(c,function(c){return a(c,b)})}),c.on("$destroy",function(){b.api.clearElement()})}}}]).factory("utils",function(){return{debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},deepExtend:function(a){var b=this;return angular.forEach(arguments,function(c){c!==a&&angular.forEach(c,function(c,d){a[d]&&a[d].constructor&&a[d].constructor===Object?b.deepExtend(a[d],c):a[d]=c})}),a}}})}(),angular.module("ark-dashboard").directive("widgetChart",function(a){return{restrict:"E",scope:{widget:"="},link:function(b,c){c.html("<div class="+b.widget.directive+"></div>"),a(c.contents())(b)}}}),angular.module("ark-dashboard").run(["$templateCache",function(a){a.put("src/dashboard/template/dashboard-layouts.html",'<div scrolling-tabs-wrapper>\n  <ul ui-sortable="sortableOptions" ng-model="layouts" class="nav nav-tabs layout-tabs">\n    <li ng-repeat="layout in layouts" ng-class="{ active: layout.active }" class="tabs-item nav-tabs-layout">\n      <a ng-click="makeLayoutActive(layout)" ng-init="addTooptip()">\n          <span ng-if="layout.locked" class="tabs-icon fonticon icon-secure"></span>\n          <span ng-if="layout.type === \'widget\'" class="tabs-icon fonticon icon-dashtab-dash"></span>\n          <span ng-if="layout.type === \'expand\'" class="tabs-icon fonticon icon-dashtab-xwidget"></span>\n          <span class="tabs-title" ng-if="layout.showTooltip" tooltip-placement="bottom" tooltip="{{layout.title}}" tooltip-popup-delay="500">{{layout.title}}</span>\n          <span class="tabs-title" ng-if="!layout.showTooltip">{{layout.title}}</span>\n      </a>\n      <div class="nav-tabs-collapse">\n          <ul class="nav">\n              <li class="ark-dropdown dropdown">\n                  <a ng-if="!layout.active" ng-click="makeLayoutActive(layout)" class="ark-dropdown-toggle nav-tabs-dropdown"><i class="icon-more"></i></a>\n                  <a ng-if="layout.active" href="#" role="button" class="ark-dropdown-toggle nav-tabs-dropdown"><i class="icon-more"></i></a>\n                  <ul ng-if="layout.active" class="dropdown-menu nav-tabs-dropdown-menu dropdown-menu-pull-left" role="menu" dropdown-menu menu="layoutList.list" layout-actions="layoutList.actions" default-layout-actions="defaultLayoutActions"></ul>\n              </li>\n          </ul>\n      </div>\n    </li>\n    <li>\n        <a ng-click="createNewLayout()" class="tabs-add-button">\n            <span class="fonticon icon-small-plus"></span>\n        </a>\n    </li>\n  </ul>\n</div>\n<div  ng-repeat="layout in layouts | filter:isActive" >\n  <div ng-if="layout.type === \'widget\'" dashboard="layout.dashboard" template-url="src/dashboard/template/dashboard.html"></div>\n  <div ng-if="layout.type === \'expand\'"expand-to-tab="layout.dashboard" template-url="src/dashboard/template/expand-to-tab.html"></div>\n</div>\n'),a.put("src/dashboard/template/dashboard.html",'<div>\n  <!--  gridster layout START -->\n  <div gridster="gridsterOpts" class="dashboard-widget-area">\n    <ul>\n      <li gridster-item="widget" ng-repeat="widget in widgets" ng-style="widget.containerStyle" class="widget-container">\n\n        <!-- START: Widget Container -->\n\n        <div class="widget">\n          <div class="widget-controls">\n            <div class="widget-drag-button">\n              <span class="fonticon icon-grab widget-anchor"></span>\n            </div>\n            <div class="nav-tabs-collapse">\n              <ul class="nav">\n                <li class="ark-dropdown dropdown">\n                  <a role="button" class="ark-dropdown-toggle nav-tabs-dropdown"><i class="icon-more"></i></a>\n                  <ul class="dropdown-menu nav-tabs-dropdown-menu dropdown-menu-pull-left"  role="menu" dropdown-menu menu="widgetList.list" widget-actions="widgetList.actions" widget="widget" default-widget-actions="defaultWidgetActions"></ul>\n                </li>\n              </ul>\n            </div>\n          </div>\n          <div class="widget-title">\n              <div ng-if="!options.hideWidgetName" class="widget-name-text">{{widget.name}}</div>\n              <div class="widget-title-text" ng-div="widget.editingTitle">{{widget.title}}</label>\n              </div>\n          </div>\n\n          <div class="widget-content">\n              <div ng-controller="widgetChart">\n                  <widget-chart widget=\'widget\'></widget-chart>\n              </div>\n          </div>\n        <!-- END: Widget Container -->\n      </li>\n    </ul>\n  </div>\n</div>\n'),
a.put("src/dashboard/template/expand-to-tab.html",'<div>\r\n  <!--  gridster layout START -->\r\n  <div gridster="gridsterOpts" class="dashboard-widget-area">\r\n    <ul>\r\n      <li gridster-item="expand" class="widget-container">\r\n\r\n        <!-- START: Widget Container -->\r\n\r\n        <div class="expand">\r\n          <div class="expand-title">\r\n              <div class="expand-title-text">{{expand.title}}</label>\r\n              </div>\r\n              <div class="expand-icons">\r\n                <i class="active fonticon icon-24-graph-bar"></i>\r\n                <i class="fonticon icon-24-graph-line"></i>\r\n                <i class="fonticon icon-24-graph-stack"></i>\r\n                <i class="fonticon icon-24-graph-grid"></i>\r\n              </div>\r\n          </div>\r\n          <div class="exapnd-content">\r\n            <div class="expand-graph">\r\n              <nvd3 options="expand.chartOptions" data="expand.chartData"></nvd3>\r\n            </div>\r\n            <div class="expand-info">\r\n              <json-tree json="expand.chartOptions" edit-level="high" collapsed-level="2" ></json-tree>\r\n            </div>\r\n          </div>\r\n\r\n        <!-- END: Widget Container -->\r\n\r\n      </li>\r\n    </ul>\r\n  </div>\r\n</div>\r\n'),a.put("src/dashboard/template/rename-template.html",'<div class="modal-header">\r\n    <span ng-click="cancel()" class="icon-close close modal-dialog-close"></span>\r\n  <h1 class="modal-header">Rename {{type}}</h1>\r\n</div>\r\n\r\n<div class="modal-body">\r\n  <form name="form" novalidate class="form-horizontal">\r\n    <div class="form-group">\r\n      <div class="col-sm-10">\r\n        <input type="text" class="form-control" name="title" ng-model="title" select-text>\r\n      </div>\r\n    </div>\r\n  </form>\r\n</div>\r\n\r\n<div class="modal-footer">\r\n  <button type="button" class="btn btn-default" ng-click="cancel()">Cancel</button>\r\n  <button type="button" class="btn btn-primary" ng-click="ok()">Rename</button>\r\n</div>'),a.put("src/dashboard/template/save-changes-modal.html",'<div class="modal-header">\n	<button type="button" class="close" data-dismiss="modal" aria-hidden="true" ng-click="cancel()">&times;</button>\n  <h3>Unsaved Changes to "{{layout.title}}"</h3>\n</div>\n\n<div class="modal-body">\n  <p>You have {{layout.dashboard.unsavedChangeCount}} unsaved changes on this dashboard. Would you like to save them?</p>\n</div>\n\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-click="cancel()">Don\'t Save</button>\n  <button type="button" class="btn btn-primary" ng-click="ok()">Save</button>\n</div>'),a.put("src/dashboard/template/widget-default-content.html",""),a.put("src/dashboard/components/dropdown-menu/dropdown-menu.html",'<li ng-repeat="item in menu" role="presentation" ng-controller="dropdownMenuController">\r\n  <a role="menuitem" tabindex="-1" ng-click="handleMenuOption(item.menuOptionKey)">\r\n    <i class="icon {{item.menuIcon}}"></i> {{item.menuLocalizedTitle}}\r\n  </a>\r\n</li>\r\n')}]);